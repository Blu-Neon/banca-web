<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Tipologia spese</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
            max-width: 480px;
            margin: auto;

            background-image: url('https://images.unsplash.com/photo-1602292678572-16cb94ea0d88?q=80&w=430&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;

            color: white;
            text-shadow: 0 0 5px black;
        }

        .box-bianca {
            background: rgba(255,255,255,0.85);
            border-radius: 20px;
            padding: 15px;
            margin-top: 20px;
            color: #222;
            text-shadow: none;
        }

        .menu-btn {
            padding: 10px;
            border-radius: 10px;
            font-size: 16px;
            border: none;
            cursor: pointer;
            width: 160px;
        }

       
    </style>
</head>
<body>
{% include "menu.html" %}

    <h2>Tipologia spese del mese</h2>

    <div class="box-bianca">
        <canvas id="torta" style="max-width:100%;"></canvas>
    </div>

    <script>
        const labels = {{ labels | tojson }};
        const dataValues = {{ values | tojson }};
        const colors = {{ colors | tojson }};

        const ctx = document.getElementById('torta');
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: labels,
                datasets: [{
                    data: dataValues,
                    backgroundColor: colors
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { display: false }
                }
            }
        });
    </script>

    <h3 style="margin-top:25px;">Legenda</h3>
    <div class="box-bianca">
        {% for item in legenda %}
            <div style="display:flex; align-items:center; margin-bottom:6px;">
                <span style="
                    display:inline-block;
                    width:16px; height:16px;
                    border-radius:4px;
                    margin-right:8px;
                    background-color:{{ item.color }};
                "></span>
                <span>{{ item.category }}: {{ "%.2f"|format(item.value) }} â‚¬</span>
            </div>
        {% endfor %}
    </div>

    {% if session.get('user_id') == 1 %}
<style>
  * {
    cursor: url("/static/cursor.png") 0 0, default !important;
  }
  button, a, input, select, textarea, label {
    cursor: url("/static/cursor.png") 0 0, pointer !important;
  }
</style>
{% endif %}

</body>
</html>
