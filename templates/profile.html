{% extends "base.html" %}

{% block title %}Profilo{% endblock %}

{% block extra_css %}
<style>
  :root {
    --card: #050815;
    --gold: #f4c97a;
    --gold-strong: #ffd992;
    --text-main: #f9fafb;
    --text-soft: #a1a1aa;
    --border-soft: rgba(148,163,184,.3);
    --radius-xl: 26px;
  }

  /* HEADER */
  .logo-title {
    text-align: center;
    margin-bottom: 14px;
  }

  .logo-title h1 {
    font-size: 1.4rem;
    letter-spacing: .16em;
    text-transform: uppercase;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 10px;
  }

  .logo-title h1::before {
    content: "";
    width: 20px;
    height: 20px;
    border-radius: 999px;
    border: 1px solid var(--gold);
    box-shadow: 0 0 16px rgba(244,201,122,.9);
  }

  .logo-title p {
    margin-top: 6px;
    font-size: .9rem;
    color: var(--text-soft);
  }

  .page-meta-line {
    margin: 10px auto 0;
    width: 72px;
    height: 2px;
    background: linear-gradient(90deg, var(--gold), transparent);
    border-radius: 999px;
  }

  /* FLASH */
  .flash-container {
    margin: 14px 0 10px;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .flash-message {
    padding: 9px 12px;
    border-radius: 999px;
    font-size: .85rem;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    border: 1px solid rgba(15,23,42,.9);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }

  .flash-message::before {
    content: "";
    width: 8px;
    height: 8px;
    border-radius: 999px;
    background: currentColor;
  }

  .flash-error {
    background: radial-gradient(circle at top, rgba(248,113,113,.24), rgba(24,24,27,.96));
    color: #fecaca;
    border-color: rgba(127, 29, 29, 0.9);
  }

  .flash-success {
    background: radial-gradient(circle at top, rgba(74,222,128,.22), rgba(24,24,27,.96));
    color: #bbf7d0;
    border-color: rgba(21, 128, 61, 0.9);
  }

  /* CARD */
  .box {
    background: radial-gradient(circle at top left, rgba(244,201,122,.05), var(--card));
    border-radius: var(--radius-xl);
    border: 1px solid var(--border-soft);
    box-shadow: 0 18px 40px rgba(15,23,42,.9);
    padding: 18px 16px;
    margin-top: 12px;
  }

  .section { margin-bottom: 16px; }

  .section-title {
    font-size: .8rem;
    text-transform: uppercase;
    letter-spacing: .16em;
    color: var(--text-soft);
    margin-bottom: 6px;
  }

  .info-row {
    font-size: .9rem;
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
  }

  .info-row span.label { color: var(--text-soft); }

  form {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-top: 8px;
  }

  input {
    padding: 10px 11px;
    font-size: .95rem;
    border-radius: 999px;
    border: 1px solid rgba(51,65,85,.9);
    background: rgba(15,23,42,.96);
    color: #e5e7eb;
    outline: none;
  }

  input:focus{
    border-color: var(--gold);
    box-shadow: 0 0 0 1px rgba(244,201,122,.55), 0 12px 28px rgba(0,0,0,.65);
  }

  .btn-primary {
    padding: 10px 14px;
    border-radius: 999px;
    border: none;
    background: radial-gradient(circle at top, var(--gold-strong), var(--gold));
    color: #18181b;
    font-weight: 600;
    cursor: pointer;
    text-transform: uppercase;
  }

  .btn-danger {
    padding: 10px 14px;
    border-radius: 999px;
    border: 1px solid rgba(248,113,113,.85);
    background: radial-gradient(circle at top, rgba(254,215,215,1), rgba(248,113,113,1));
    color: #111827;
    font-weight: 700;
    cursor: pointer;
    text-transform: uppercase;
  }

  .back-link {
    text-align: center;
    margin-top: 10px;
    font-size: .8rem;
  }

  .back-link a {
    color: var(--gold-strong);
    text-decoration: none;
  }

  .back-link a:hover { text-decoration: underline; }
</style>
{% endblock %}

{% block content %}
  <div class="logo-title">
    <h1>Il tuo profilo</h1>
    <p>Gestisci le impostazioni del tuo account.</p>
    <div class="page-meta-line"></div>
  </div>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="flash-container">
        {% for category, msg in messages %}
          <div class="flash-message {% if category=='error' %}flash-error{% else %}flash-success{% endif %}">
            {{ msg }}
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <div class="box">
    {# ✅ QUI ci va il contenuto “vero” del profilo.
       Incolla qui la tua vecchia parte (info utente, cambio password, delete account, ecc.) #}

    <!-- ESEMPIO (puoi cancellare/modificare): -->
    <div class="section">
      <div class="section-title">Dati account</div>
      <div class="info-row">
        <span class="label">Username:</span>
        <span>{{ username if username is defined else "—" }}</span>
      </div>
      <div class="info-row">
        <span class="label">Email:</span>
        <span>{{ email if email is defined else "—" }}</span>
      </div>
    </div>

    <div class="section">
      <div class="section-title">Cambia password</div>
      <form method="POST" action="{{ url_for('change_password') if 'change_password' in (globals()|list) else '#' }}">
        <input type="password" name="old_password" placeholder="Password attuale" required>
        <input type="password" name="new_password" placeholder="Nuova password" required>
        <button class="btn-primary" type="submit">Aggiorna</button>
      </form>
    </div>

    <div class="section">
      <div class="section-title">Sicurezza</div>
      <form method="POST" action="{{ url_for('delete_account') if 'delete_account' in (globals()|list) else '#' }}">
        <button class="btn-danger" type="submit">Elimina account</button>
      </form>
    </div>

    <div class="back-link">
      <a href="{{ url_for('tipo') }}">⟵ Torna alla home</a>
    </div>
  </div>
{% endblock %}
