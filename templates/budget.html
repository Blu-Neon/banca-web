{% extends "base.html" %}

{% block title %}Budget viaggio{% endblock %}

{% block extra_head %}
  <style>
    /* ====== PAGE CSS (Budget viaggio) ======
       Nota: niente :root / body / app-shell qui, perché stanno nel base.html */

    /* HEADER */
    .page-header {
      text-align: center;
      margin-bottom: 18px;
    }

    .page-header h1 {
      font-size: 1.5rem;
      letter-spacing: .18em;
      text-transform: uppercase;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 10px;
    }

    .page-header h1::before {
      content: "";
      width: 22px;
      height: 22px;
      border-radius: 999px;
      border: 1px solid var(--gold);
      box-shadow: 0 0 18px rgba(244,201,122,.9);
    }

    .page-header p {
      margin-top: 6px;
      font-size: .9rem;
      color: var(--text-soft);
    }

    .page-meta-line {
      margin: 12px auto 0;
      width: 72px;
      height: 2px;
      background: linear-gradient(90deg, var(--gold), transparent);
      border-radius: 999px;
    }

    /* BUDGET ATTUALE */
    .current-budget-wrapper {
      display: flex;
      justify-content: center;
      margin-bottom: 14px;
    }

    .current-budget {
      padding: 7px 12px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,.5);
      background: radial-gradient(circle at top left, rgba(244,201,122,.16), rgba(15,23,42,.95));
      font-size: .82rem;
      color: var(--text-soft);
    }

    .current-budget strong {
      font-size: .95rem;
      color: var(--gold-strong);
      margin-left: 6px;
    }

    /* CARD */
    .box {
      background: radial-gradient(circle at top left, rgba(244,201,122,.07), var(--card));
      border-radius: var(--radius-xl);
      border: 1px solid var(--border-soft);
      box-shadow: 0 18px 40px rgba(15,23,42,.9);
      padding: 18px 16px;
    }

    /* ✅ qui evitiamo di “stirare” il box su desktop */
    .box-narrow {
      max-width: 520px;
      margin: 0 auto;
    }

    .subtitle {
      text-align: center;
      font-size: .85rem;
      color: var(--text-soft);
      margin-bottom: 14px;
    }

    /* DISPLAY IMPORTO */
    .amount-display-wrapper {
      margin-bottom: 18px;
      background: radial-gradient(circle at top, rgba(15,23,42,.96), #020617);
      border-radius: 18px;
      padding: 10px 12px;
      border: 1px solid rgba(148,163,184,.55);
    }

    .amount-label-row {
      display: flex;
      justify-content: space-between;
      font-size: .78rem;
      color: var(--text-soft);
      margin-bottom: 4px;
    }

    .amount-display {
      width: 100%;
      text-align: right;
      font-size: 2.1rem;
      border: none;
      background: transparent;
      color: #fff;
      outline: none;
      font-variant-numeric: tabular-nums;
    }

    /* KEYPAD */
    .keypad {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-bottom: 18px;
    }

    .keypad button {
      padding: 14px 0;
      font-size: 1.25rem;
      border-radius: 16px;
      border: 1px solid rgba(31,41,55,.95);
      background: radial-gradient(circle at top, rgba(148,163,184,.16), rgba(15,23,42,.96));
      color: #fff;
      cursor: pointer;
      box-shadow: 0 10px 22px rgba(0,0,0,.6);
      transition: transform .12s ease, box-shadow .12s ease, filter .12s ease;
    }

    .keypad button:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 28px rgba(0,0,0,.75);
      filter: brightness(1.03);
    }

    .keypad button:active {
      transform: translateY(0) scale(.98);
      box-shadow: 0 10px 22px rgba(0,0,0,.6);
    }

    .keypad .btn-special { color: var(--gold-strong); }
    .keypad .btn-special:last-child { color: #fecaca; }

    /* BUTTON */
    .btn-primary {
      width: 100%;
      padding: 12px;
      border-radius: 999px;
      border: none;
      background: radial-gradient(circle at top, var(--gold-strong), var(--gold));
      color: #18181b;
      font-weight: 600;
      cursor: pointer;
      text-transform: uppercase;
      box-shadow: 0 16px 32px rgba(0,0,0,.85);
      margin-bottom: 8px;
      transition: transform .12s ease, box-shadow .12s ease, filter .12s ease;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 20px 40px rgba(0,0,0,.95);
      filter: brightness(1.02);
    }

    .btn-primary:active {
      transform: translateY(0) scale(.98);
      box-shadow: 0 12px 26px rgba(0,0,0,.85);
    }

    .back-link { text-align: center; }
    .back-link a {
      font-size: .8rem;
      text-decoration: none;
      color: #e5e7eb;
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,.5);
      background: rgba(15,23,42,.7);
      display: inline-block;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .back-link a:hover {
      transform: translateY(-1px);
      background: rgba(15,23,42,.9);
      border-color: rgba(244,201,122,.35);
    }
    .back-link a:active { transform: translateY(0); }
  </style>
{% endblock %}

{% block content %}

  <header class="page-header">
    <h1>Budget viaggio</h1>
    <p>Imposta il tetto massimo che non vuoi superare durante il viaggio.</p>
    <div class="page-meta-line"></div>
  </header>

  <div class="current-budget-wrapper">
    <div class="current-budget">
      Budget attuale <strong>{{ budget }} €</strong>
    </div>
  </div>

  <div class="box box-narrow">
    <p class="subtitle">Definisci il nuovo budget con il tastierino numerico.</p>

    <form method="POST" action="{{ url_for('budget') }}">
      <div class="amount-display-wrapper">
        <div class="amount-label-row">
          <span>Nuovo budget</span>
          <span>EUR €</span>
        </div>
        <input type="text" id="amount-input" name="amount" class="amount-display" readonly value="0">
      </div>

      <div class="keypad">
        <button type="button" onclick="addDigit('1')">1</button>
        <button type="button" onclick="addDigit('2')">2</button>
        <button type="button" onclick="addDigit('3')">3</button>
        <button type="button" onclick="addDigit('4')">4</button>
        <button type="button" onclick="addDigit('5')">5</button>
        <button type="button" onclick="addDigit('6')">6</button>
        <button type="button" onclick="addDigit('7')">7</button>
        <button type="button" onclick="addDigit('8')">8</button>
        <button type="button" onclick="addDigit('9')">9</button>
        <button type="button" class="btn-special" onclick="addDigit(',')">,</button>
        <button type="button" onclick="addDigit('0')">0</button>
        <button type="button" class="btn-special" onclick="delDigit()">⌫</button>
      </div>

      <button type="submit" class="btn-primary">Imposta budget ✓</button>
    </form>

    <div class="back-link">
      <a href="{{ url_for('tipo') }}">⟵ Indietro</a>
    </div>
  </div>

{% endblock %}

{% block scripts %}
  <script>
    const input = document.getElementById('amount-input');

    function addDigit(d) {
      if (input.value === '0' && d !== ',') {
        input.value = d;
      } else {
        if (d === ',' && input.value.includes(',')) return;
        input.value += d;
      }
    }

    function delDigit() {
      input.value = input.value.length <= 1 ? '0' : input.value.slice(0, -1);
    }
  </script>
{% endblock %}
